machine:
    # Setting timezone takes quite a bit of time
    # timezone:
    #     Europe/Stockholm
    ruby:
    python:
    pre:
    environment:
        PATH: $PATH:$HOME/.evm/bin:$HOME/.cask/bin
        EMACS: evm-emacs
dependencies:
    pre:
        - ci/prereqs.sh
    cache_directories:
        - "~/.emacs.d"
        - "~/.evm"
        - "~/.evms"
        - "~/.cask"
test:
    override:
        - ci/evm-matrix.sh $CIRCLE_NODE_INDEX $CIRCLE_NODE_TOTAL:
            parallel: true
deployment:
    bitbucket:
        branch: master
        commands:
            - evm use emacs-25.1 || evm install --use emacs-25.1
            - ci/publish.sh -c -u "Ola Nilsson" -e "ola.nilsson@gmail.com" buttercup-junit.el
    publish-test:
        branch: /.*/
        commands:
            - evm use emacs-25.1 || evm install --use emacs-25.1
            - ci/publish.sh -P -c -u "Ola Nilsson" -e "ola.nilsson@gmail.com" buttercup-junit.el

