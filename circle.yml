machine:
    # Setting timezone takes quite a bit of time
    # timezone:
    #     Europe/Stockholm
    ruby:
    python:
    pre:
    environment:
        PATH: $PATH:$HOME/.evm/bin:$HOME/.cask/bin
        EMACS: evm-emacs
dependencies:
    pre:
        - sudo apt-get -qq update
        - sudo apt-get -qq install emacs24 libxpm-dev libncurses5-dev texinfo liblockfile-dev librsvg2-dev autoconf automake autotools-dev sharutils zlib1g-dev
        - sudo DEBIAN_FRONTEND=noninteractive apt-get -y -qq build-dep emacs24 || true
        - curl -fsSkL --retry 9 --retry-delay 9 https://raw.github.com/rejeep/evm/master/go | bash
        - mkdir -p ~/.evms
        - evm config path ~/.evms
    post:
        - with_x_toolkit=n with_xml2=y evm install --use emacs-25.1
        - curl -fsSL https://raw.githubusercontent.com/cask/cask/master/go | python
test:
    override:
        - ci/evm-matrix.sh $CIRCLE_NODE_INDEX $CIRCLE_NODE_TOTAL:
            parallel: true
deployment:
    bitbucket:
        branch: master
        commands:
            - evm install --use emacs-25.1-travis
            - ci/publish.sh -c -u "Ola Nilsson" -e "ola.nilsson@gmail.com" buttercup-junit.el

